let cartCount = 0;let popupMounted = false;let popupShown = false;let currentSlide = 0;let slideInterval;document.addEventListener('DOMContentLoaded',function(){console.log('BLOM Cosmetics website loading...');initAnnouncementBanner();initSignupPopup();initNavigation();initMobileNavigation();initCartFunctionality();initScrollAnimations();initFormHandlers();initExpandableDropdowns();initVideoAutoplay();syncCartCount();console.log('BLOM Cosmetics website loaded successfully!')} function initExpandableDropdowns(){const expandableTitles = document.querySelectorAll('.mega-menu-title.expandable');expandableTitles.forEach(title =>{title.addEventListener('click',function(e){e.preventDefault();e.stopPropagation();const targetId = this.getAttribute('data-target');const content = document.getElementById(targetId);const icon = this.querySelector('.expand-icon');if (content){this.classList.toggle('expanded');content.classList.toggle('expanded');if (this.classList.contains('expanded')){icon.textContent = 'âˆ’'} else{icon.textContent = '+'} } })})} function initAnnouncementBanner(){const banner = document.getElementById('announcement-banner');const joinBtn = document.getElementById('announcement-join-btn');const closeBtn = document.getElementById('announcement-close');if (!banner) return;const isDismissed = localStorage.getItem('blom_banner_dismissed');if (isDismissed === '1'){banner.classList.add('hidden');return} if (joinBtn){joinBtn.addEventListener('click',function(e){e.preventDefault();openSignupPopup()})} if (closeBtn){closeBtn.addEventListener('click',function(e){e.preventDefault();e.stopPropagation();dismissAnnouncementBanner()})} banner.addEventListener('click',function(e){if (e.target !== closeBtn){e.preventDefault();openSignupPopup()} })} function dismissAnnouncementBanner(){const banner = document.getElementById('announcement-banner');if (banner){banner.classList.add('hidden');localStorage.setItem('blom_banner_dismissed','1')} } function initSignupPopup(){const popup = document.getElementById('signup-popup');const form = document.getElementById('signup-form');const closeBtn = document.getElementById('popup-close');if (!popup) return;setTimeout(() =>{const popupDismissedThisSession = sessionStorage.getItem('popupDismissedThisSession');if (!popupDismissedThisSession && !popupShown){openSignupPopup()} },5000);if (closeBtn){closeBtn.addEventListener('click',function(e){e.preventDefault();closeSignupPopup()})} popup.addEventListener('click',function(e){if (e.target === popup){closeSignupPopup()} });document.addEventListener('keydown',function(e){if (e.key === 'Escape' && popup.classList.contains('active')){closeSignupPopup()} });if (form){form.addEventListener('submit',function(e){e.preventDefault();handleSignupSubmission()})} } function openSignupPopup(){const popup = document.getElementById('signup-popup');if (popup && !popupShown){popup.classList.add('active');document.body.style.overflow = 'hidden';popupShown = true;const firstInput = popup.querySelector('input');if (firstInput){setTimeout(() => firstInput.focus(),200)} } } function closeSignupPopup(){const popup = document.getElementById('signup-popup');if (popup){popup.classList.remove('active');document.body.style.overflow = 'auto';sessionStorage.setItem('popupDismissedThisSession','1')} } function handleSignupSubmission(){const form = document.getElementById('signup-form');const submitBtn = form.querySelector('.signup-submit-btn');const emailInput = form.querySelector('input[type="email"]');if (!emailInput.value || !isValidEmail(emailInput.value)){showNotification('Please enter a valid email address','error');return} submitBtn.textContent = 'Joining...';submitBtn.disabled = true;setTimeout(() =>{showNotification('Welcome to the BLOM Beauty Club! Check your email for your 15% discount code.','success');closeSignupPopup();form.reset();submitBtn.textContent = 'Join Now & Save 15%';submitBtn.disabled = false},2000)} function initNavigation(){const navItems = document.querySelectorAll('.nav-item');navItems.forEach(item =>{const link = item.querySelector('a');const dropdown = item.querySelector('.dropdown-menu,.mega-menu');if (dropdown && link && link.classList.contains('has-dropdown')){link.addEventListener('click',function(e){e.preventDefault();navItems.forEach(otherItem =>{if (otherItem !== item){const otherDropdown = otherItem.querySelector('.dropdown-menu,.mega-menu');const otherLink = otherItem.querySelector('a');if (otherDropdown && otherLink){otherDropdown.classList.remove('show');otherLink.setAttribute('aria-expanded','false')} } });const isOpen = dropdown.classList.contains('show');if (isOpen){dropdown.classList.remove('show');link.setAttribute('aria-expanded','false')} else{dropdown.classList.add('show');link.setAttribute('aria-expanded','true')} })} });document.addEventListener('click',function(e){if (!e.target.closest('.nav-item')){navItems.forEach(item =>{const dropdown = item.querySelector('.dropdown-menu,.mega-menu');const link = item.querySelector('a');if (dropdown && link){dropdown.classList.remove('show');link.setAttribute('aria-expanded','false')} })} })} function initMobileNavigation(){console.log('Initializing mobile navigation...');const setupMobileNav = () =>{const mobileToggle = document.querySelector('.mobile-nav-toggle');const mobileOverlay = document.getElementById('mobile-nav-overlay');const mobileDrawer = document.getElementById('mobile-nav-drawer');const mobileClose = document.querySelector('.mobile-nav-close');console.log('Mobile nav elements:',{toggle:!!mobileToggle,overlay:!!mobileOverlay,drawer:!!mobileDrawer,close:!!mobileClose });if (!mobileToggle || !mobileOverlay || !mobileDrawer){console.error('Mobile nav elements not found!');return false} const newToggle = mobileToggle.cloneNode(true);mobileToggle.parentNode.replaceChild(newToggle,mobileToggle);newToggle.addEventListener('click',function(e){e.preventDefault();e.stopPropagation();console.log('Mobile toggle clicked!');const isOpen = mobileDrawer.classList.contains('active');console.log('Current state:',isOpen ? 'open' :'closed');if (isOpen){mobileDrawer.classList.remove('active');mobileOverlay.classList.remove('active');newToggle.classList.remove('active');document.body.style.overflow = '';console.log('Menu closed')} else{mobileDrawer.classList.add('active');mobileOverlay.classList.add('active');newToggle.classList.add('active');document.body.style.overflow = 'hidden';console.log('Menu opened');setTimeout(() =>{console.log('After opening - Drawer classes:',mobileDrawer.className);console.log('After opening - Overlay classes:',mobileOverlay.className);console.log('After opening - Toggle classes:',newToggle.className);console.log('Drawer computed style display:',window.getComputedStyle(mobileDrawer).display);console.log('Overlay computed style display:',window.getComputedStyle(mobileOverlay).display)},100)} });if (mobileClose){mobileClose.addEventListener('click',function(e){e.preventDefault();e.stopPropagation();console.log('Close button clicked');mobileDrawer.classList.remove('active');mobileOverlay.classList.remove('active');newToggle.classList.remove('active');document.body.style.overflow = ''})} mobileOverlay.addEventListener('click',function(e){e.preventDefault();e.stopPropagation();console.log('Overlay clicked');mobileDrawer.classList.remove('active');mobileOverlay.classList.remove('active');newToggle.classList.remove('active');document.body.style.overflow = ''});console.log('Mobile navigation setup complete');return true};if (!setupMobileNav()){setTimeout(() =>{console.log('Retrying mobile nav setup...');setupMobileNav()},100)} document.addEventListener('click',function(e){if (e.target.closest('.mobile-nav-toggle')){console.log('Global mobile toggle click detected');const mobileDrawer = document.getElementById('mobile-nav-drawer');const mobileOverlay = document.getElementById('mobile-nav-overlay');const mobileToggle = document.querySelector('.mobile-nav-toggle');if (mobileDrawer && mobileOverlay && mobileToggle){const isOpen = mobileDrawer.classList.contains('active');console.log('Global handler - Current state:',isOpen ? 'open' :'closed');if (isOpen){mobileDrawer.classList.remove('active');mobileOverlay.classList.remove('active');mobileToggle.classList.remove('active');document.body.style.overflow = ''} else{mobileDrawer.classList.add('active');mobileOverlay.classList.add('active');mobileToggle.classList.add('active');document.body.style.overflow = 'hidden'} } } });document.querySelectorAll('.mobile-accordion-toggle').forEach(toggle =>{toggle.addEventListener('click',function(){const content = this.nextElementSibling;const icon = this.querySelector('.mobile-accordion-icon');const isActive = content.classList.contains('active');document.querySelectorAll('.mobile-accordion-content').forEach(acc =>{acc.classList.remove('active')});document.querySelectorAll('.mobile-accordion-toggle').forEach(t =>{t.setAttribute('aria-expanded','false');const i = t.querySelector('.mobile-accordion-icon');if (i) i.style.transform = 'rotate(0deg)'});if (!isActive){content.classList.add('active');this.setAttribute('aria-expanded','true');if (icon) icon.style.transform = 'rotate(180deg)'} })})} function initCartFunctionality(){document.querySelectorAll('.btn-add-cart,.add-to-cart,.shop-card-button').forEach(button =>{button.addEventListener('click',function(e){e.preventDefault();e.stopPropagation();const productName = this.dataset.product || this.dataset.title || 'Product';addToCart(productName)})});const storedCount = localStorage.getItem('blom_cart_count');if (storedCount){cartCount = parseInt(storedCount);updateCartDisplay()} } function addToCart(productName){cartCount++;updateCartDisplay();localStorage.setItem('blom_cart_count',cartCount.toString());document.dispatchEvent(new CustomEvent('cart:updated'));showNotification(`${productName} added to cart!`)} function updateCartDisplay(){const cartCountElements = document.querySelectorAll('.cart-count');cartCountElements.forEach(element =>{element.textContent = cartCount;element.classList.add('cart-bounce');setTimeout(() => element.classList.remove('cart-bounce'),600)})} function syncCartCount(){const storedCount = localStorage.getItem('blom_cart_count');if (storedCount){cartCount = parseInt(storedCount);updateCartDisplay()} } function initScrollAnimations(){const observerOptions ={threshold:0.1,rootMargin:'0px 0px -50px 0px' };const observer = new IntersectionObserver(function(entries){entries.forEach(entry =>{if (entry.isIntersecting){entry.target.classList.add('visible');if (entry.target.classList.contains('trust-item')){entry.target.classList.add('is-in')} } })},observerOptions);document.querySelectorAll('.fade-in,.trust-item').forEach(el =>{observer.observe(el)});document.querySelectorAll('.trust-item').forEach((item,index) =>{item.style.setProperty('--delay',`${index * 100}ms`)})} function initFormHandlers(){const newsletterBtn = document.querySelector('.newsletter-btn');if (newsletterBtn){newsletterBtn.addEventListener('click',function(e){e.preventDefault();const emailInput = document.querySelector('.newsletter-input');const email = emailInput.value.trim();if (email && isValidEmail(email)){showNotification('Thank you for subscribing to BLOM updates!');emailInput.value = ''} else{showNotification('Please enter a valid email address','error')} })} document.querySelectorAll('.newsletter').forEach(form =>{form.addEventListener('submit',function(e){e.preventDefault();const emailInput = this.querySelector('.newsletter-input');const email = emailInput.value.trim();if (email && isValidEmail(email)){showNotification('Thank you for subscribing!');emailInput.value = ''} else{showNotification('Please enter a valid email address','error')} })});const heroBtnPrimary = document.querySelector('.hero-btn-primary');if (heroBtnPrimary){heroBtnPrimary.addEventListener('click',function(e){e.preventDefault();window.location.href = 'shop.html'})} const heroBtnSecondary = document.querySelector('.hero-btn-secondary');if (heroBtnSecondary){heroBtnSecondary.addEventListener('click',function(e){e.preventDefault();window.location.href = 'courses.html'})} const educationBtn = document.querySelector('.education-btn,.myc__cta');if (educationBtn){educationBtn.addEventListener('click',function(e){e.preventDefault();window.location.href = 'courses.html'})} const viewAllBtn = document.querySelector('.view-all-btn');if (viewAllBtn){viewAllBtn.addEventListener('click',function(e){e.preventDefault();window.location.href = 'shop.html'})} document.querySelectorAll('.social-link').forEach(link =>{if (!link.href || link.href === '#'){link.addEventListener('click',function(e){e.preventDefault();showNotification('Opening social media page...')})} });document.querySelectorAll('a[href^="#"]').forEach(anchor =>{anchor.addEventListener('click',function (e){e.preventDefault();const href = this.getAttribute('href');const target = href === '#' ? document.documentElement :document.querySelector(href);if (target){target.scrollIntoView({behavior:'smooth',block:'start' })} })});window.addEventListener('scroll',function(){const header = document.querySelector('.header');if (header){if (window.scrollY > 100){header.classList.add('scrolled')} else{header.classList.remove('scrolled')} } });document.querySelectorAll('.faq-question').forEach(question =>{question.addEventListener('click',function(){const faqItem = this.closest('.faq-item');const isActive = faqItem.classList.contains('active');document.querySelectorAll('.faq-item').forEach(item =>{if (item !== faqItem){item.classList.remove('active')} });if (isActive){faqItem.classList.remove('active')} else{faqItem.classList.add('active')} })})} function isValidEmail(email){const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;return emailRegex.test(email)} function showNotification(message,type = 'success'){const existingNotification = document.querySelector('.notification-toast');if (existingNotification){existingNotification.remove()} const notification = document.createElement('div');notification.className = `notification-toast ${type}`;notification.textContent = message;document.body.appendChild(notification);setTimeout(() =>{notification.classList.add('show')},100);setTimeout(() =>{notification.classList.remove('show');setTimeout(() =>{if (notification.parentNode){notification.remove()} },300)},3000)} window.Cart ={add:addToCart,getCount:() => cartCount,getTotal:() => 0 };function initVideoAutoplay(){const video = document.querySelector('.myc__image video');if (!video) return;const observer = new IntersectionObserver((entries) =>{entries.forEach(entry =>{if (entry.isIntersecting){video.play().catch(error =>{console.log('Video autoplay failed:',error)})} else{video.pause()} })},{threshold:0.5 });observer.observe(video)} document.addEventListener('DOMContentLoaded',function(){const yearElement = document.getElementById('year');if (yearElement){yearElement.textContent = new Date().getFullYear()} initContactForm()});function initContactForm(){const contactForm = document.getElementById('contact-form');if (!contactForm) return;contactForm.addEventListener('submit',function(e){e.preventDefault();handleContactFormSubmission(this)});const inputs = contactForm.querySelectorAll('input,select,textarea');inputs.forEach(input =>{input.addEventListener('blur',function(){validateContactField(this)});input.addEventListener('input',function(){clearFieldError(this)})})} function handleContactFormSubmission(form){const submitBtn = form.querySelector('.contact-submit-btn');const formData = new FormData(form);const isValid = validateContactForm(form);if (!isValid){showNotification('Please fill in all required fields correctly','error');return} const originalText = submitBtn.textContent;submitBtn.textContent = 'Sending...';submitBtn.disabled = true;setTimeout(() =>{showNotification('Thank you for your message! We\'ll get back to you within 1 business day.','success');form.reset();submitBtn.textContent = originalText;submitBtn.disabled = false},2000)} function validateContactForm(form){const requiredFields = form.querySelectorAll('[required]');let isValid = true;requiredFields.forEach(field =>{if (!validateContactField(field)){isValid = false} });return isValid} function validateContactField(field){const value = field.value.trim();const fieldName = field.name;let isValid = true;let errorMessage = '';clearFieldError(field);if (field.hasAttribute('required') && !value){errorMessage = 'This field is required';isValid = false} if (fieldName === 'email' && value && !isValidEmail(value)){errorMessage = 'Please enter a valid email address';isValid = false} if (fieldName === 'phone' && value && !/^[\+]?[0-9\s\-\(\)]{10,}$/.test(value)){errorMessage = 'Please enter a valid phone number';isValid = false} if (!isValid){showFieldError(field,errorMessage)} return isValid} function showFieldError(field,message){field.classList.add('error');const existingError = field.parentNode.querySelector('.field-error');if (existingError){existingError.remove()} const errorDiv = document.createElement('div');errorDiv.className = 'field-error';errorDiv.textContent = message;field.parentNode.appendChild(errorDiv)} function clearFieldError(field){field.classList.remove('error');const errorDiv = field.parentNode.querySelector('.field-error');if (errorDiv){errorDiv.remove()} }